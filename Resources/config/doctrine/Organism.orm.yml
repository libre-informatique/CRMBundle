Librinfo\CRMBundle\Entity\Organism:
    type: entity
    repositoryClass: Librinfo\CRMBundle\Entity\Repository\OrganismRepository
    inheritanceType: JOINED
    discriminatorColumn:
        name: discriminator
        type: string
    blast:
        loggable: true
    fields:
        firstname:
            type:       string(255)
            nullable:   true
        lastname:
            type:       string(255)
            nullable: true
        shortname:
            type:       string(255)
            nullable:   true
        title:
            type:       string(255)
            nullable:   true
        flashOnControl:
            type:       string
            nullable:   true
        familyContact:
            type:       boolean
            nullable:   true
        culture:
            type:       string(2)
            nullable:   true
        url:
            type:       string
            length:     255
            nullable:   true
        administrativeNumber:
            type:       string
            length:     255
            nullable:   true
        isIndividual:
            type: boolean
            options:
                default: false
        isCustomer:
            type: boolean
            options:
                default: false
        customerCode:
            type:       string
            length:     255
            nullable:   true
        isSupplier:
            type: boolean
            options:
                default: false
        supplierCode:
            type:       string
            length:     255
            nullable:   true
        iban:
            type:       string
            length:     255
            nullable:   true
        vat:
            type:       string
            length:     255
            nullable:   true
        vatVerified:
            type: smallint
            options:
                default: 0
        alert:
            type:       string
            length:     255
            nullable:   true
        active:
            type:       boolean
        catalogue_sent:
            type:       boolean
            nullable:   true
        last_catalogue_sent_date:
            type:       date
            nullable:   true
        first_catalogue_sent_date:
            type:       date
            nullable:   true
        catalogue_send_mean:
            type: text
            nullable: true
        source:
            type: text
            nullable: true

    oneToOne:
        defaultAddress:
            targetEntity: Librinfo\CRMBundle\Entity\Address
            joinColumn:
                name: default_address_id
                onDelete: SET NULL
            cascade: [persist, remove]
            orphanRemoval: true
        defaultPhone:
            targetEntity: Librinfo\CRMBundle\Entity\OrganismPhone
            joinColumn:
                name: default_phone_id
                onDelete: SET NULL
            cascade: [persist]
            orphanRemoval: true

    oneToMany:
        phones:
            targetEntity: OrganismPhone
            mappedBy: organism
            cascade: [ persist, remove ]
            orphanRemoval: true
        individuals:
            targetEntity: Librinfo\CRMBundle\Entity\Position
            mappedBy: organization
            cascade: [ persist, remove ]
            orphanRemoval: true
        organizations:
            targetEntity: Librinfo\CRMBundle\Entity\Position
            mappedBy: individual
            cascade: [ persist, remove ]
            orphanRemoval: true
        addresses:
            targetEntity: Librinfo\CRMBundle\Entity\Address
            mappedBy: organism
            cascade: [ persist, remove ]
            orphanRemoval: true

    manyToMany:
        circles:
            targetEntity: Librinfo\CRMBundle\Entity\Circle
            inversedBy: organisms
            joinTable:
                name: ~
                joinColumns:
                    circle_id:
                        referencedColumnName: id
                inverseJoinColumns:
                    organism_id:
                        referencedColumnName: id

    manyToOne:
        category:
            targetEntity: Librinfo\CRMBundle\Entity\Category
            inversedBy: organisms
            joinColumn:
                name: category_id
                onDelete: set null
            cascade: [ persist ]